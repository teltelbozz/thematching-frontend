<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒãƒƒãƒãƒ³ã‚°çµæœãƒ‡ãƒ¢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- TailwindCSS CDNï¼ˆã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ã®ãƒšãƒ¼ã‚¸ãªã®ã§ OKï¼‰ -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      background: #f5f6fa;
    }
  </style>
</head>

<body class="p-4">
  <div class="max-w-3xl mx-auto">

    <h1 class="text-3xl font-bold mb-6 text-center">
      ãƒãƒƒãƒãƒ³ã‚°çµæœãƒ‡ãƒ¢
    </h1>

    <!-- SlotDt å…¥åŠ› -->
    <div class="mb-6 bg-white p-4 rounded shadow">
      <label class="block text-gray-700 font-semibold mb-2">
        Slot Datetimeï¼ˆä¾‹ï¼š2025-12-05T19:00:00+09:00ï¼‰
      </label>
      <input id="slotDtInput"
             type="text"
             class="border rounded w-full px-3 py-2"
             value="2025-12-05T19:00:00+09:00" />

      <button onclick="loadResults()"
              class="bg-blue-600 text-white px-4 py-2 rounded mt-3 hover:bg-blue-700">
        èª­ã¿è¾¼ã‚€
      </button>
    </div>

    <!-- çµæœ -->
    <div id="resultArea"></div>

  </div>

  <script>
    async function loadResults() {
      const slotDt = document.getElementById("slotDtInput").value;
      const encoded = encodeURIComponent(slotDt);

      const url = `https://thematching-backend.vercel.app/admin/matching-results?slotDt=${encoded}`;

      const area = document.getElementById("resultArea");
      area.innerHTML = `<p class="text-gray-600">èª­ã¿è¾¼ã¿ä¸­...</p>`;

      try {
        const res = await fetch(url);
        const data = await res.json();

        if (!data.ok) {
          area.innerHTML = `<p class="text-red-600">ã‚¨ãƒ©ãƒ¼: ${data.error}</p>`;
          return;
        }

        const groups = data.groups;

        area.innerHTML = `
          <h2 class="text-xl font-bold mb-4">
            ãƒãƒƒãƒãƒ³ã‚°çµæœï¼ˆ${groups.length}çµ„ï¼‰
          </h2>
        `;

        groups.forEach((g, idx) => {
          const html = `
            <div class="bg-white p-4 rounded shadow mb-4">
              <h3 class="text-lg font-bold mb-2">
                ã‚°ãƒ«ãƒ¼ãƒ— ${idx + 1}
              </h3>

              <p class="text-gray-700 mb-2">
                <span class="font-semibold">Token:</span> ${g.token}
              </p>

              <div class="grid grid-cols-2 gap-4">

                <!-- å¥³æ€§ -->
                <div>
                  <h4 class="text-pink-600 font-bold mb-1">å¥³æ€§</h4>
                  ${g.female.map(f => `
                    <div class="border rounded p-2 mb-2">
                      <p>ğŸ‘¤ <span class="font-semibold">${f.nickname}</span></p>
                      <p>å¹´é½¢: ${f.age}</p>
                      <p>ID: ${f.user_id}</p>
                    </div>
                  `).join("")}
                </div>

                <!-- ç”·æ€§ -->
                <div>
                  <h4 class="text-blue-600 font-bold mb-1">ç”·æ€§</h4>
                  ${g.male.map(m => `
                    <div class="border rounded p-2 mb-2">
                      <p>ğŸ‘¤ <span class="font-semibold">${m.nickname}</span></p>
                      <p>å¹´é½¢: ${m.age}</p>
                      <p>ID: ${m.user_id}</p>
                    </div>
                  `).join("")}
                </div>

              </div>
            </div>
          `;

          area.innerHTML += html;
        });

      } catch (e) {
        area.innerHTML = `<p class="text-red-600">é€šä¿¡ã‚¨ãƒ©ãƒ¼</p>`;
      }
    }
  </script>

</body>
</html>